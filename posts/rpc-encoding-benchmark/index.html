<!DOCTYPE html>
<html lang="en" class="dark light">

    <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="base" content="https:&#x2F;&#x2F;stevenlusonggao.github.io&#x2F;blog">

    

    
    
    
        <title>
            
                Base64 vs Base64+Zstd: Comparing Solana&#x27;s getAccountInfo Call Reponse Encoding
            
        </title>

        
            <meta property="og:title"
                  content="Base64 vs Base64+Zstd: Comparing Solana&#x27;s getAccountInfo Call Reponse Encoding" />
        
    

    
        
            <meta property="og:description" content="My Blog" />
        
    

    
        
            <meta name="description" content="My Blog" />
        
    

    
    
        <link rel="icon"
              type="image/png"
              href="https://stevenlusonggao.github.io/blog/favicon.png" />
    

    
    
        <link href=https://stevenlusonggao.github.io/blog/fonts.css rel="stylesheet" />
    

    
    

    
    

    
    <script defer src=https://stevenlusonggao.github.io/blog/js/codeblock.js></script>

    
    <script defer src=https://stevenlusonggao.github.io/blog/js/toc.js></script>

    
    
        <script src=https://stevenlusonggao.github.io/blog/js/note.js></script>
    

    
        
            <script>
            MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };
            </script>
        
        <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
        </script>
    

    
    


    
    
        <link rel="stylesheet"
              type="text/css"
              href="https://stevenlusonggao.github.io/blog/theme/light.css" />
        <link id="darkModeStyle"
              rel="stylesheet"
              type="text/css"
              href="https://stevenlusonggao.github.io/blog/theme/dark.css" />
    

    <!-- Set the correct theme in the script -->

    
        <script src=https://stevenlusonggao.github.io/blog/js/themetoggle.js></script>

        
            <script>setTheme(getSavedTheme());</script>
        
    


    <link rel="stylesheet"
          type="text/css"
          media="screen"
          href="https://stevenlusonggao.github.io/blog/main.css" />

    

    
        <script defer
                src="https://stevenlusonggao.github.io/blog/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e"></script></head>


    <body>
        <div class="left-content">
            
            
        </div>

        <div class="content">
            <nav>
    <div class="left-nav">
        
            <a href=https:&#x2F;&#x2F;stevenlusonggao.github.io&#x2F;blog>Steven Lu Song Gao</a>
        


        <div class="socials">
            
                <a rel="me" href="https:&#x2F;&#x2F;github.com&#x2F;stevenlusonggao" class="social">
                    <img alt="github"
                         src="https://stevenlusonggao.github.io/blog/icons/social/github.svg">
                </a>
            
                <a rel="me" href="https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;stevenlusonggao&#x2F;" class="social">
                    <img alt="linkedin"
                         src="https://stevenlusonggao.github.io/blog/icons/social/linkedin.svg">
                </a>
            
                <a rel="me" href="mailto:steven.lusong@gmail.com" class="social">
                    <img alt="email"
                         src="https://stevenlusonggao.github.io/blog/icons/social/email.svg">
                </a>
            
        </div>
    </div>

    <div class="right-nav">
        
            <a href=https://stevenlusonggao.github.io/blog/posts style="margin-right: 0.5em">&#x2F;posts</a>
        
            <a href=https://stevenlusonggao.github.io/blog/tags style="margin-right: 0.5em">&#x2F;tags</a>
        

        
            <button id="search-button"
                    class="search-button"
                    title="$SHORTCUT to open search">
                <img src="https://stevenlusonggao.github.io/blog/icons/search.svg"
                     alt="Search"
                     class="search-icon">
            </button>

            <div id="searchModal"
                 class="search-modal js"
                 role="dialog"
                 aria-labelledby="modalTitle">
                <div id="modal-content">
                    <h1 id="modalTitle" class="page-header">Search</h1>
                    <div id="searchBar">
                        <input id="searchInput"
                               role="combobox"
                               autocomplete="off"
                               spellcheck="false"
                               aria-expanded="false"
                               aria-controls="results-container"
                               placeholder="Search..." />
                        <button id="clear-search" class="clear-button" title="Clear search">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                                <path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z" />
                            </svg>
                        </button>
                    </div>
                    <div id="results-container">
                        <div id="results-info">
                            <span id="zero_results" style="display: none;">No results</span>
                            <span id="one_result" style="display: none;">1 result</span>
                            <span id="many_results" style="display: none;">$NUMBER results</span>
                        </div>
                        <div id="results" role="listbox"></div>
                    </div>
                </div>
            </div>
        

        
            <a id="dark-mode-toggle"
               onclick="toggleTheme(); event.preventDefault();"
               href="#">
                <img src="https://stevenlusonggao.github.io/blog/icons/sun.svg"
                     id="sun-icon"
                     style="filter: invert(1)"
                     alt="Light" />
                <img src=https://stevenlusonggao.github.io/blog/icons/moon.svg id="moon-icon" alt="Dark" />
            </a>

            <!-- Initialize the theme toggle icons -->
            <script>updateItemToggleTheme()</script>
        
    </div>
</nav>


            
            
    
    <div class="visible-element-observer-root" data-selector="main article p">
        <main>
            <article>
                <div class="title">
                    
                    
    <div class="page-header">Base64 vs Base64+Zstd: Comparing Solana&#x27;s getAccountInfo Call Reponse Encoding</div>


                    <div class="meta">
                        
                            Posted on <time>2025-10-09</time>
                        


                        

                        

                        

                        
                        

                        
                        

                        
                        
                            <span class="tags-label">::</span>
                            <span class="tags">
                                    <a href="https://stevenlusonggao.github.io/blog/tags/solana/"
                                       class="post-tag">solana</a>
                                
                                    <a href="https://stevenlusonggao.github.io/blog/tags/rust/"
                                       class="post-tag">rust</a>
                                
                            </span>
                        

                        

                    </div>
                </div>

                

                <section class="body">
                    <p>The following writeup describes the results of my experiment comparing the measured latencies of using <code>"encoding" = "base64</code> vs <code>"encoding" = "base64+zstd"</code> for Solana's <a href="https://solana.com/docs/rpc/http/getaccountinfo">getAccountInfo</a> RPC call.</p>
<h1 id="key-takeaways"><a class="zola-anchor" href="#key-takeaways" aria-label="Anchor link for: key-takeaways">Key Takeaways</a></h1>
<ul>
<li><strong>For smaller accounts (&lt;3KB)</strong>: <code>base64</code>'s mean latency is faster than <code>base64+zstd</code></li>
<li><strong>For larger accounts (&gt;5KB)</strong>: <code>base64+zstd</code>'s mean latency is faster than <code>base64</code></li>
<li>A crossover point exists between ~3KB and ~5KB account sizes where <code>base64+zstd</code> begins to outperform <code>base64</code></li>
<li>Looking at the 95th percentile latency time, we can see that they yield comparable results as mean latencies, where <code>base64</code> outperforms with smaller account data, while <code>base64+zstd</code> outperforms with larger data accounts.</li>
</ul>
<pre style="background-color:#0f1419;color:#bfbab0;"><code><span>=== SUMMARY ANALYSIS (MEAN) - getAccountInfo===
</span><span>
</span><span>Size (B)   Base64 (ms)  Zstd (ms)    Diff (ms)    P-value                        Winner
</span><span>================================================================================
</span><span>904        20.67        24.40        3.73         HIGHLY SIGNIFICANT (p &lt; 0.01)  Base64
</span><span>3232       25.43        30.95        5.52         HIGHLY SIGNIFICANT (p &lt; 0.01)  Base64
</span><span>5400       35.03        25.18        9.85         HIGHLY SIGNIFICANT (p &lt; 0.01)  Zstd
</span><span>7448       25.36        20.89        4.47         HIGHLY SIGNIFICANT (p &lt; 0.01)  Zstd
</span><span>10136      23.58        21.41        2.17         HIGHLY SIGNIFICANT (p &lt; 0.01)  Zstd
</span><span>
</span></code></pre>
<pre style="background-color:#0f1419;color:#bfbab0;"><code><span>=== SUMMARY ANALYSIS (P95) - getAccountInfo===
</span><span>
</span><span>Size (B)   Base64 (ms)  Zstd (ms)    Diff (ms)    Winner
</span><span>================================================================================
</span><span>904        27.71        32.81        5.09         Base64
</span><span>3232       34.34        36.81        2.47         Base64
</span><span>5400       43.93        33.82        10.11        Zstd
</span><span>7448       33.84        27.53        6.31         Zstd
</span><span>10136      30.54        28.70        1.84         Zstd
</span><span>
</span></code></pre>
<h1 id="methodology"><a class="zola-anchor" href="#methodology" aria-label="Anchor link for: methodology">Methodology</a></h1>
<ul>
<li><strong>RPC Method Tested</strong>: <a href="https://solana.com/docs/rpc/http/getaccountinfo">getAccountInfo</a> (single account call)</li>
<li><strong>RPC Provider</strong>: <a href="https://www.helius.dev/pricing">Helius</a> paid developer plan</li>
<li><strong>Sample Size</strong>: 1,000 RPC requests per account size, for each encoding type</li>
<li><strong>For each request, I measured end-to-end latency</strong>: the time from sending the RPC request to receiving and decoding and decompressing the complete response</li>
<li>I collected the mean, media, stdev, min value, max value, and P95/P95 values from each account size</li>
</ul>
<h2 id="test-accounts"><a class="zola-anchor" href="#test-accounts" aria-label="Anchor link for: test-accounts">Test Accounts</a></h2>
<table><thead><tr><th>Account Size</th><th>Address</th></tr></thead><tbody>
<tr><td>904 bytes</td><td><code>Po57HwPXoG22SajaQCBn7Zg8hPp15pUTMcTwcr4GhDu</code></td></tr>
<tr><td>3,232 bytes</td><td><code>2uLdBfEax2Gzk3KRGTiWoYQPmXWgSG6g1UDax1T9J6MM</code></td></tr>
<tr><td>5,400 bytes</td><td><code>4yRzzxU6brZsY9CTZ2Jp9QWhnRftYP6RyZ8FGugVEXN8</code></td></tr>
<tr><td>7,448 bytes</td><td><code>CXh2s3cJVwJxZBa7q2ur3paKsWrrznZfApmvjQCPQJpc</code></td></tr>
<tr><td>10,136 bytes</td><td><code>Hij4zmmrdmQ49bfgy63C8VF12EYysjF6WGFeZJpfipCk</code></td></tr>
</tbody></table>
<h2 id="example-result-output"><a class="zola-anchor" href="#example-result-output" aria-label="Anchor link for: example-result-output">Example Result Output</a></h2>
<pre style="background-color:#0f1419;color:#bfbab0;"><code><span>============================================================
</span><span>Testing GetAccountInfo with 3232 byte account, address: 2uLdBfEax2Gzk3KRGTiWoYQPmXWgSG6g1UDax1T9J6MM
</span><span>============================================================
</span><span>
</span><span>[base64] .................................................. Completed
</span><span>[base64+zstd]   .................................................. Completed
</span><span>
</span><span>GetAccountInfo call, base64 - 3232 bytes:
</span><span>  Mean:      25.43 ms
</span><span>  Median:    24.00 ms
</span><span>  Std Dev:   5.79 ms
</span><span>  Min:       19.43 ms
</span><span>  Max:       80.75 ms
</span><span>  P95:       34.34 ms
</span><span>  P99:       50.08 ms
</span><span>  Successful calls: 1000
</span><span>
</span><span>GetAccountInfo call, base64+zstd - 3232 bytes:
</span><span>  Mean:      30.95 ms
</span><span>  Median:    29.94 ms
</span><span>  Std Dev:   5.02 ms
</span><span>  Min:       25.10 ms
</span><span>  Max:       98.74 ms
</span><span>  P95:       36.81 ms
</span><span>  P99:       46.61 ms
</span><span>  Successful calls: 1000
</span></code></pre>
<h1 id="understanding-getaccountinfo-encoding-types"><a class="zola-anchor" href="#understanding-getaccountinfo-encoding-types" aria-label="Anchor link for: understanding-getaccountinfo-encoding-types">Understanding <code>getAccountInfo</code> Encoding Types</a></h1>
<h2 id="what-is-base64-encoding"><a class="zola-anchor" href="#what-is-base64-encoding" aria-label="Anchor link for: what-is-base64-encoding">What is <code>base64</code> Encoding?</a></h2>
<p>When you request account data via <code>getAccountInfo</code> from a Solana RPC node, the raw binary account data needs to be transmitted over HTTP/JSON. Since JSON cannot directly represent binary data, Solana uses <a href="https://www.freecodecamp.org/news/what-is-base64-encoding/">base64</a> encoding to convert binary data into ASCII text.</p>
<p>The process of encoding data using base64 increases the data size by ~33%, but it is a necessary tradeoff for reliable data transmission over JSON-RPC.</p>
<h2 id="what-is-base64-zstd"><a class="zola-anchor" href="#what-is-base64-zstd" aria-label="Anchor link for: what-is-base64-zstd">What is <code>base64+zstd</code>?</a></h2>
<p><a href="https://facebook.github.io/zstd/">Zstandard (Zstd)</a> is a modern compression algorithm developed by Facebook that offers fast compression and decompression speeds and good compression ratios.</p>
<p>In the context of Solana, zstd compresses the account data before base64 encoding, reducing the amount of data transmitted over the network. The general logic steps for handling <code>base64+zstd</code> encoding in a Solana RPC call includes:</p>
<p><strong>Server-side (RPC node):</strong></p>
<ol>
<li>Fetch raw account data from storage</li>
<li>Compress the binary data using <code>zstd</code></li>
<li>Encode the compressed data with <code>base64</code></li>
<li>Send JSON response with compressed+encoded data</li>
</ol>
<p><strong>Client-side:</strong></p>
<ol>
<li>Receive JSON response</li>
<li>Use <code>base64</code> to decode to get compressed binary</li>
<li>Decompress using <code>zstd</code> to get original account data</li>
</ol>
<p>Using <code>base64+zstd</code>, you save network bandwidth latency due to a smaller data size, but at the cost of latency from additional CPU cycles for compression/decompression.</p>
<p><strong>The question is: at what data size does the benefit of compression outweight the additional CPU overhead it costs?</strong></p>
<h1 id="interpretation-of-results"><a class="zola-anchor" href="#interpretation-of-results" aria-label="Anchor link for: interpretation-of-results">Interpretation of Results</a></h1>
<p>After conducting the experiment described in the Methodology section above, the following takeaways could be retrieved from the data:</p>
<ul>
<li><strong>For smaller accounts (&lt;3KB)</strong>: <code>base64</code>'s mean latency is faster than <code>base64+zstd</code></li>
<li><strong>For larger accounts (&gt;5KB)</strong>: <code>base64+zstd</code>'s mean latency is faster than <code>base64</code></li>
</ul>
<p>These results are in line with my expectations as they adhered to the tradeoff princible between bandwidth savings and additional costs from decompression.</p>
<p>Every RPC call has three latency components:</p>
<ol>
<li><strong>Network Latency</strong>: latency dependent on the quality of the client and server's respective networks</li>
<li><strong>Data Transfer</strong>: latency from bandwidth</li>
<li><strong>CPU Processing</strong>: latency from CPU cycles needed to compress and decompress the data</li>
</ol>
<p>At smaller data sizes, you're spending extra CPU resources for decompression but not saving enough latency from a smaller data size transfer.</p>
<p>At larger data sizes, the bandwidth savings exceed the overhead from the additional decompression. A crossover point exists between ~3KB and ~5KB account sizes where <code>base64+zstd</code> begins to outperform <code>base64</code>.</p>
<p><strong>Small Data Accounts:</strong></p>
<pre style="background-color:#0f1419;color:#bfbab0;"><code><span>base64 costs:     Network + Small Data transfer + CPU for decoding
</span><span>base64+zstd costs:       Network + Tiny Data transfer + CPU for decoding and decompressing
</span></code></pre>
<p><strong>Larger Data Accounts:</strong></p>
<pre style="background-color:#0f1419;color:#bfbab0;"><code><span>base64 costs:     Network + Larger Data transfer + CPU for decoding
</span><span>base64+zstd costs:       Network + Medium Data transfer + CPU for decoding and decompressing
</span></code></pre>
<!--
# Testing for Significance: Welch's T-Test

To determine if observed performance differences is a real signal or just random noise, I used [**Welch's t-test**](https://sites.nicholas.duke.edu/statsreview/means/welch/), a statistical method for comparing two groups with potentially different variances.

The t-statistic formula I used:

```
t = |mean₁ - mean₂| / √((s₁²/n₁) + (s₂²/n₂))
```

Where:
- `mean₁, mean₂`: Average latencies for `base64` and `base64+zstd`
- `s₁, s₂`: Standard deviations
- `n₁, n₂`: Sample sizes

## Interpreting the T-Statistic

For an n=1000 sample size, the t-distribution likely approximates to a normal distribution. The critical values are The t-statistic tells us how many standard errors apart the two means are:

- **t > 2.58**: Highly significant (p < 0.01) - Less than 1% chance this is random
- **t > 1.96**: Significant (p < 0.05) - Less than 5% chance this is random
- **t < 1.96**: Not significant - Could be random variation

All our tests showed **t > 2.58**, meaning we can be 99% confident the performance differences are real.
-->

                </section>
            </article>
        </main>
    </div>



            
                
            

            
        </div>

        <div class="right-content">
            
    
    
        <div class="toc">
    <div class="heading">Table of Contents</div>
    <ul class="toc-list">
        
            <li class="parent">
                
                <a href="https://stevenlusonggao.github.io/blog/posts/rpc-encoding-benchmark/#key-takeaways">Key Takeaways</a>

                
            </li>
        
            <li class="parent">
                
                <a href="https://stevenlusonggao.github.io/blog/posts/rpc-encoding-benchmark/#methodology">Methodology</a>

                
                    <ul>
                        
                            
                            <li>
                                <a href="https://stevenlusonggao.github.io/blog/posts/rpc-encoding-benchmark/#test-accounts">Test Accounts</a>
                            </li>

                            
                        
                            
                            <li>
                                <a href="https://stevenlusonggao.github.io/blog/posts/rpc-encoding-benchmark/#example-result-output">Example Result Output</a>
                            </li>

                            
                        
                    </ul>
                
            </li>
        
            <li class="parent">
                
                <a href="https://stevenlusonggao.github.io/blog/posts/rpc-encoding-benchmark/#understanding-getaccountinfo-encoding-types">Understanding getAccountInfo Encoding Types</a>

                
                    <ul>
                        
                            
                            <li>
                                <a href="https://stevenlusonggao.github.io/blog/posts/rpc-encoding-benchmark/#what-is-base64-encoding">What is base64 Encoding?</a>
                            </li>

                            
                        
                            
                            <li>
                                <a href="https://stevenlusonggao.github.io/blog/posts/rpc-encoding-benchmark/#what-is-base64-zstd">What is base64+zstd?</a>
                            </li>

                            
                        
                    </ul>
                
            </li>
        
            <li class="parent">
                
                <a href="https://stevenlusonggao.github.io/blog/posts/rpc-encoding-benchmark/#interpretation-of-results">Interpretation of Results</a>

                
            </li>
        
    </ul>
</div>

    

        </div>
    </body>

</html>
